/*! Fabrik */

!function(){var c,s,n=0,p=[],t={},a={},i={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},r=/[<>&\"\']/g,f=window.setTimeout,o={};function l(){this.returnValue=!1}function d(){this.cancelBubble=!0}!function(e){var t,n,i,r="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,text/csv,csv,text/plain,asc txt text diff log,application/octet-stream,exe".split(/,/);for(t=0;t<r.length;t+=2)for(i=r[t+1].split(/ /),n=0;n<i.length;n++)a[i[n]]=r[t]}();var e,u,g,h,m,v,b={VERSION:"1.5.1.1",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:a,ua:(h=navigator,m=h.userAgent,v=h.vendor,g=(e=/WebKit/.test(m))&&-1!==v.indexOf("Apple"),u=window.opera&&window.opera.buildNumber,{windows:-1!==navigator.platform.indexOf("Win"),ie:!e&&!u&&/MSIE/gi.test(m)&&/Explorer/gi.test(h.appName),webkit:e,gecko:!e&&/Gecko/.test(m),safari:g,opera:!!u}),extend:function(n){return b.each(arguments,function(e,t){0<t&&b.each(e,function(e,t){n[t]=e})}),n},cleanName:function(e){var t,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=(e=e.replace(/\s+/g,"_")).replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(e,t){return t.name=e,p[e]=t,p.push(t),t},guid:function(){var e,t=(new Date).getTime().toString(32);for(e=0;e<5;e++)t+=Math.floor(65535*Math.random()).toString(32);return(b.guidPrefix||"p")+t+(n++).toString(32)},buildUrl:function(e,t){var n="";return b.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(0<e.indexOf("?")?"&":"?")+n),e},each:function(e,t){var n,i,r;if(e)if((n=e.length)===c){for(i in e)if(e.hasOwnProperty(i)&&!1===t(e[i],i))return}else for(r=0;r<n;r++)if(!1===t(e[r],r))return},formatSize:function(e){return e===c||/\D/.test(e)?b.translate("N/A"):1073741824<e?Math.round(e/1073741824,1)+" GB":1048576<e?Math.round(e/1048576,1)+" MB":1024<e?Math.round(e/1024,1)+" KB":e+" b"},getPos:function(e,t){var n,i,r,a=0,s=0,o=document;function l(e){var t,n,i=0,r=0;return e&&(n=e.getBoundingClientRect(),t="CSS1Compat"===o.compatMode?o.documentElement:o.body,i=n.left+t.scrollLeft,r=n.top+t.scrollTop),{x:i,y:r}}if(e=e,t=t||o.body,e&&e.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==o.documentMode)return i=l(e),r=l(t),{x:i.x-r.x,y:i.y-r.y};for(n=e;n&&n!=t&&n.nodeType;)a+=n.offsetLeft||0,s+=n.offsetTop||0,n=n.offsetParent;for(n=e.parentNode;n&&n!=t&&n.nodeType;)a-=n.scrollLeft||0,s-=n.scrollTop||0,n=n.parentNode;return{x:a,y:s}},getSize:function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}},parseSize:function(e){var t;return"string"==typeof e&&(t=(e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")))[2],e=+e[1],"g"==t&&(e*=1073741824),"m"==t&&(e*=1048576),"k"==t&&(e*=1024)),e},xmlEncode:function(e){return e?(""+e).replace(r,function(e){return i[e]?"&"+i[e]+";":e}):e},toArray:function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},addI18n:function(e){return b.extend(t,e)},translate:function(e){return t[e]||e},isEmptyObj:function(e){if(e===c)return!0;for(var t in e)return!1;return!0},hasClass:function(e,t){return""!=e.className&&new RegExp("(^|\\s+)"+t+"(\\s+|$)").test(e.className)},addClass:function(e,t){b.hasClass(e,t)||(e.className=""==e.className?t:e.className.replace(/\s+$/,"")+" "+t)},removeClass:function(e,t){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return" "===t&&" "===n?" ":""})},getStyle:function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},addEvent:function(e,t,n){var i,r,a;a=arguments[3],t=t.toLowerCase(),s===c&&(s="Plupload_"+b.guid()),e.addEventListener?(i=n,e.addEventListener(t,i,!1)):e.attachEvent&&(i=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=l,e.stopPropagation=d,n(e)},e.attachEvent("on"+t,i)),e[s]===c&&(e[s]=b.guid()),o.hasOwnProperty(e[s])||(o[e[s]]={}),(r=o[e[s]]).hasOwnProperty(t)||(r[t]=[]),r[t].push({func:i,orig:n,key:a})},removeEvent:function(t,e){var n,i,r;if("function"==typeof arguments[2]?i=arguments[2]:r=arguments[2],e=e.toLowerCase(),t[s]&&o[t[s]]&&o[t[s]][e]){for(var a=(n=o[t[s]][e]).length-1;0<=a&&(n[a].key!==r&&n[a].orig!==i||(t.detachEvent?t.detachEvent("on"+e,n[a].func):t.removeEventListener&&t.removeEventListener(e,n[a].func,!1),n[a].orig=null,n[a].func=null,n.splice(a,1),i===c));a--);if(n.length||delete o[t[s]][e],b.isEmptyObj(o[t[s]])){delete o[t[s]];try{delete t[s]}catch(e){t[s]=c}}}},removeAllEvents:function(n){var i=arguments[1];n[s]!==c&&n[s]&&b.each(o[n[s]],function(e,t){b.removeEvent(n,t,i)})}};b.Uploader=function(l){var n,i,r={},d=[];function u(){var e,t,n=0;if(this.state==b.STARTED){for(t=0;t<d.length;t++)e||d[t].status!=b.QUEUED?n++:((e=d[t]).status=b.UPLOADING,this.trigger("BeforeUpload",e)&&this.trigger("UploadFile",e));n==d.length&&(this.stop(),this.trigger("UploadComplete",d))}}function g(){var e,t;for(n.reset(),e=0;e<d.length;e++)(t=d[e]).size!==c?(n.size+=t.size,n.loaded+=t.loaded):n.size=c,t.status==b.DONE?n.uploaded++:t.status==b.FAILED?n.failed++:n.queued++;n.size===c?n.percent=0<d.length?Math.ceil(n.uploaded/d.length*100):0:(n.bytesPerSec=Math.ceil(n.loaded/((+new Date-i||1)/1e3)),n.percent=0<n.size?Math.ceil(n.loaded/n.size*100):0)}n=new b.QueueProgress,l=b.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},l),b.extend(this,{state:b.STOPPED,runtime:"",features:{},files:d,settings:l,total:n,id:b.guid(),init:function(){var t,a,e,o=this,s=0;if("function"==typeof l.preinit?l.preinit(o):b.each(l.preinit,function(e,t){o.bind(t,e)}),l.page_url=l.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/"),/^(\w+:\/\/|\/)/.test(l.url)||(l.url=l.page_url+l.url),l.chunk_size=b.parseSize(l.chunk_size),l.max_file_size=b.parseSize(l.max_file_size),o.bind("FilesAdded",function(e,t){var n,i,r,a=0,s=l.filters;for(s&&s.length&&(r=[],b.each(s,function(e){b.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?r.push("\\.*"):r.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),r=new RegExp(r.join("|")+"$","i")),n=0;n<t.length;n++)(i=t[n]).loaded=0,i.percent=0,i.status=b.QUEUED,!r||r.test(i.name)?i.size!==c&&i.size>l.max_file_size?e.trigger("Error",{code:b.FILE_SIZE_ERROR,message:b.translate("File size error."),file:i}):(d.push(i),a++):e.trigger("Error",{code:b.FILE_EXTENSION_ERROR,message:b.translate("File extension error."),file:i});if(!a)return!1;f(function(){o.trigger("QueueChanged"),o.refresh()},1)}),l.unique_names&&o.bind("UploadFile",function(e,t){var n=t.name.match(/\.([^.]+)$/),i="tmp";n&&(i=n[1]),t.target_name=t.id+"."+i}),o.bind("UploadProgress",function(e,t){t.percent=0<t.size?Math.ceil(t.loaded/t.size*100):100,g()}),o.bind("StateChanged",function(e){if(e.state==b.STARTED)i=+new Date;else if(e.state==b.STOPPED)for(t=e.files.length-1;0<=t;t--)e.files[t].status==b.UPLOADING&&(e.files[t].status=b.QUEUED,g())}),o.bind("QueueChanged",g),o.bind("Error",function(e,t){t.file&&(t.file.status=b.FAILED,g(),e.state==b.STARTED&&f(function(){u.call(o)},1))}),o.bind("FileUploaded",function(e,t){t.status=b.DONE,t.loaded=t.size,e.trigger("UploadProgress",t),f(function(){u.call(o)},1)}),l.runtimes)for(a=[],e=l.runtimes.split(/\s?,\s?/),t=0;t<e.length;t++)p[e[t]]&&a.push(p[e[t]]);else a=p;!function t(){var n,e,i,r=a[s++];if(r){if(n=r.getFeatures(),e=o.settings.required_features)for(e=e.split(","),i=0;i<e.length;i++)if(!n[e[i]])return void t();r.init(o,function(e){e&&e.success?(o.features=n,o.runtime=r.name,o.trigger("Init",{runtime:r.name}),o.trigger("PostInit"),o.refresh()):t()})}else o.trigger("Error",{code:b.INIT_ERROR,message:b.translate("Init error.")})}(),"function"==typeof l.init?l.init(o):b.each(l.init,function(e,t){o.bind(t,e)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=b.STARTED&&(this.state=b.STARTED,this.trigger("StateChanged"),u.call(this))},stop:function(){this.state!=b.STOPPED&&(this.state=b.STOPPED,this.trigger("StateChanged"))},getFile:function(e){var t;for(t=d.length-1;0<=t;t--)if(d[t].id===e)return d[t]},removeFile:function(e){var t;for(t=d.length-1;0<=t;t--)if(d[t].id===e.id)return this.splice(t,1)[0]},splice:function(e,t){var n;return n=d.splice(e===c?0:e,t===c?d.length:t),this.trigger("FilesRemoved",n),this.trigger("QueueChanged"),n},trigger:function(e){var t,n,i=r[e.toLowerCase()];if(i)for((n=Array.prototype.slice.call(arguments))[0]=this,t=0;t<i.length;t++)if(!1===i[t].func.apply(i[t].scope,n))return!1;return!0},hasEventListener:function(e){return!!r[e.toLowerCase()]},bind:function(e,t,n){var i;e=e.toLowerCase(),(i=r[e]||[]).push({func:t,scope:n||this}),r[e]=i},unbind:function(e){e=e.toLowerCase();var t,n=r[e],i=arguments[1];if(n){if(i!==c){for(t=n.length-1;0<=t;t--)if(n[t].func===i){n.splice(t,1);break}}else n=[];n.length||delete r[e]}},unbindAll:function(){var n=this;b.each(r,function(e,t){n.unbind(t)})},destroy:function(){this.trigger("Destroy"),this.unbindAll()}})},b.File=function(e,t,n){var i=this;i.id=e,i.name=t,i.size=n,i.loaded=0,i.percent=0,i.status=0},b.Runtime=function(){this.getFeatures=function(){},this.init=function(e,t){}},b.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},b.runtimes={},window.plupload=b}(),function(){if(!window.google||!google.gears){var t=null;if("undefined"!=typeof GearsFactory)t=new GearsFactory;else try{-1!=(t=new ActiveXObject("Gears.Factory")).getBuildInfo().indexOf("ie_mobile")&&t.privateSetGlobalObject(this)}catch(e){void 0!==navigator.mimeTypes&&navigator.mimeTypes["application/x-googlegears"]&&((t=document.createElement("object")).style.display="none",t.width=0,t.height=0,t.type="application/x-googlegears",document.documentElement.appendChild(t))}t&&(window.google||(window.google={}),google.gears||(google.gears={factory:t}))}}(),function(e,r,y,t){var _={};y.runtimes.Gears=y.addRuntime("gears",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(s,t){var o;if(!e.google||!google.gears)return t({success:!1});try{o=google.gears.factory.create("beta.desktop")}catch(e){return t({success:!1})}function l(e){var t,n,i,r=[];for(n=0;n<e.length;n++)t=e[n],i=y.guid(),_[i]=t.blob,r.push(new y.File(i,t.name,t.blob.length));s.trigger("FilesAdded",r)}s.bind("PostInit",function(){var a=s.settings,e=r.getElementById(a.drop_element);e&&(y.addEvent(e,"dragover",function(e){o.setDropEffect(e,"copy"),e.preventDefault()},s.id),y.addEvent(e,"drop",function(e){var t=o.getDragData(e,"application/x-gears-files");t&&l(t.files),e.preventDefault()},s.id),e=0),y.addEvent(r.getElementById(a.browse_button),"click",function(e){var t,n,i,r=[];e.preventDefault();e:for(t=0;t<a.filters.length;t++)for(i=a.filters[t].extensions.split(","),n=0;n<i.length;n++){if("*"===i[n]){r=[];break e}r.push("."+i[n])}o.openFiles(l,{singleFile:!a.multi_selection,filter:r})},s.id)}),s.bind("UploadFile",function(p,f){var h,m,v,b=0,E=0,e=p.settings.resize;e&&/\.(png|jpg|jpeg)$/i.test(f.name)&&(_[f.id]=function(e,t,n){var i,r;i=google.gears.factory.create("beta.canvas");try{if(i.decode(e),t.width||(t.width=i.width),t.height||(t.height=i.height),(r=Math.min(width/i.width,height/i.height))<1||1===r&&"image/jpeg"===n)return i.resize(Math.round(i.width*r),Math.round(i.height*r)),t.quality?i.encode(n,{quality:t.quality/100}):i.encode(n)}catch(e){}return e}(_[f.id],e,/\.png$/i.test(f.name)?"image/png":"image/jpeg")),f.size=_[f.id].length,m=p.settings.chunk_size,v=0<m,h=Math.ceil(f.size/m),v||(m=f.size,h=1),function t(){var n,i,e,r,a,s,o,l,d=p.settings.multipart,u=0,g={name:f.target_name||f.name},c=p.settings.url;f.status!=y.DONE&&f.status!=y.FAILED&&p.state!=y.STOPPED&&(v&&(g.chunk=b,g.chunks=h),i=Math.min(m,f.size-b*m),d||(c=y.buildUrl(p.settings.url,g)),(n=google.gears.factory.create("beta.httprequest")).open("POST",c),d||(n.setRequestHeader("Content-Disposition",'attachment; filename="'+f.name+'"'),n.setRequestHeader("Content-Type","application/octet-stream")),y.each(p.settings.headers,function(e,t){n.setRequestHeader(t,e)}),n.upload.onprogress=function(e){f.loaded=E+e.loaded-u,p.trigger("UploadProgress",f)},n.onreadystatechange=function(){var e;if(4==n.readyState)if(200==n.status){if(e={chunk:b,chunks:h,response:n.responseText,status:n.status},p.trigger("ChunkUploaded",f,e),e.cancelled)return void(f.status=y.FAILED);E+=i,++b>=h?(f.status=y.DONE,p.trigger("FileUploaded",f,{response:n.responseText,status:n.status})):t()}else p.trigger("Error",{code:y.HTTP_ERROR,message:y.translate("HTTP Error."),file:f,chunk:b,chunks:h,status:n.status})},b<h&&(e=_[f.id].slice(b*m,i),o="----pluploadboundary"+y.guid(),l="\r\n",d&&(n.setRequestHeader("Content-Type","multipart/form-data; boundary="+o),r=google.gears.factory.create("beta.blobbuilder"),y.each(y.extend(g,p.settings.multipart_params),function(e,t){r.append("--"+o+l+'Content-Disposition: form-data; name="'+t+'"'+l+l),r.append(e+l)}),s=y.mimeTypes[f.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",r.append("--"+o+l+'Content-Disposition: form-data; name="'+p.settings.file_data_name+'"; filename="'+f.name+'"'+l+"Content-Type: "+s+l+l),r.append(e),r.append(l+"--"+o+"--"+l),a=r.getAsBlob(),u=a.length-e.length,e=a),n.send(e)))}()}),s.bind("Destroy",function(e){var t,n,i={browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(t in i)(n=r.getElementById(i[t]))&&y.removeAllEvents(n,e.id)}),t({success:!0})}})}(window,document,plupload),function(a,u,g,c){var p={},f={};g.silverlight={trigger:function(e,t){var n,i=p[e];i&&((n=g.toArray(arguments).slice(1))[0]="Silverlight:"+t,setTimeout(function(){i.trigger.apply(i,n)},0))}},g.runtimes.Silverlight=g.addRuntime("silverlight",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(s,e){var t,n,i="",r=s.settings.filters,l=u.body;if(!function(t){var n,i,r,a,s,o=!1,l=0;try{try{new ActiveXObject("AgControl.AgControl").IsVersionSupported(t)&&(o=!0)}catch(e){var d=navigator.plugins["Silverlight Plug-In"];if(d){for("1.0.30226.2"===(n=d.description)&&(n="2.0.30226.2"),i=n.split(".");3<i.length;)i.pop();for(;i.length<4;)i.push(0);for(r=t.split(".");4<r.length;)r.pop();for(;a=parseInt(r[l],10),s=parseInt(i[l],10),++l<r.length&&a===s;);a<=s&&!isNaN(a)&&(o=!0)}}}catch(e){o=!1}return o}("2.0.31005.0")||a.opera&&a.opera.buildNumber)e({success:!1});else{for(f[s.id]=!1,p[s.id]=s,(t=u.createElement("div")).id=s.id+"_silverlight_container",g.extend(t.style,{position:"absolute",top:"0px",background:s.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100px",height:"100px",overflow:"hidden",opacity:s.settings.shim_bgcolor||8<u.documentMode?"":.01}),t.className="plupload silverlight",s.settings.container&&(l=u.getElementById(s.settings.container),"static"===g.getStyle(l,"position")&&(l.style.position="relative")),l.appendChild(t),n=0;n<r.length;n++)i+=(""!=i?"|":"")+r[n].title+" | *."+r[n].extensions.replace(/,/g,";*.");t.innerHTML='<object id="'+s.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" style="outline:none;" width="1024" height="1024"><param name="source" value="'+s.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="id='+s.id+",filter="+i+",multiselect="+s.settings.multi_selection+'"/></object>',s.bind("Silverlight:Init",function(){var a,o={};f[s.id]||(f[s.id]=!0,s.bind("Silverlight:StartSelectFiles",function(e){a=[]}),s.bind("Silverlight:SelectFile",function(e,t,n,i){var r;r=g.guid(),o[r]=t,o[t]=r,a.push(new g.File(r,n,i))}),s.bind("Silverlight:SelectSuccessful",function(){a.length&&s.trigger("FilesAdded",a)}),s.bind("Silverlight:UploadChunkError",function(e,t,n,i,r){s.trigger("Error",{code:g.IO_ERROR,message:"IO Error.",details:r,file:e.getFile(o[t])})}),s.bind("Silverlight:UploadFileProgress",function(e,t,n,i){var r=e.getFile(o[t]);r.status!=g.FAILED&&(r.size=i,r.loaded=n,e.trigger("UploadProgress",r))}),s.bind("Refresh",function(e){var t,n,i;(t=u.getElementById(e.settings.browse_button))&&(n=g.getPos(t,u.getElementById(e.settings.container)),i=g.getSize(t),g.extend(u.getElementById(e.id+"_silverlight_container").style,{top:n.y+"px",left:n.x+"px",width:i.w+"px",height:i.h+"px"}))}),s.bind("Silverlight:UploadChunkSuccessful",function(e,t,n,i,r){var a,s=e.getFile(o[t]);a={chunk:n,chunks:i,response:r},e.trigger("ChunkUploaded",s,a),s.status!=g.FAILED&&d().UploadNextChunk(),n==i-1&&(s.status=g.DONE,e.trigger("FileUploaded",s,{response:r}))}),s.bind("Silverlight:UploadSuccessful",function(e,t,n){var i=e.getFile(o[t]);i.status=g.DONE,e.trigger("FileUploaded",i,{response:n})}),s.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)d().RemoveFile(o[t[n].id])}),s.bind("UploadFile",function(e,t){var n=e.settings,i=n.resize||{};d().UploadFile(o[t.id],e.settings.url,function e(t){var i,n,r,a,s=typeof t;if(t===c||null===t)return"null";if("string"===s)return i="\bb\tt\nn\ff\rr\"\"''\\\\",'"'+t.replace(/([\u0080-\uFFFF\x00-\x1f\"])/g,function(e,t){var n=i.indexOf(t);return n+1?"\\"+i.charAt(n+1):(e=t.charCodeAt().toString(16),"\\u"+"0000".substring(e.length)+e)})+'"';if("object"==s){if(n=t.length!==c,i="",n){for(r=0;r<t.length;r++)i&&(i+=","),i+=e(t[r]);i="["+i+"]"}else{for(a in t)t.hasOwnProperty(a)&&(i&&(i+=","),i+=e(a)+":"+e(t[a]));i="{"+i+"}"}return i}return""+t}({name:t.target_name||t.name,mime:g.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:n.chunk_size,image_width:i.width,image_height:i.height,image_quality:i.quality||90,multipart:!!n.multipart,multipart_params:n.multipart_params||{},file_data_name:n.file_data_name,headers:n.headers}))}),s.bind("Silverlight:MouseEnter",function(e){var t,n;t=u.getElementById(s.settings.browse_button),n=e.settings.browse_button_hover,t&&n&&g.addClass(t,n)}),s.bind("Silverlight:MouseLeave",function(e){var t,n;t=u.getElementById(s.settings.browse_button),n=e.settings.browse_button_hover,t&&n&&g.removeClass(t,n)}),s.bind("Silverlight:MouseLeftButtonDown",function(e){var t,n;t=u.getElementById(s.settings.browse_button),n=e.settings.browse_button_active,t&&n&&(g.addClass(t,n),g.addEvent(u.body,"mouseup",function(){g.removeClass(t,n)}))}),s.bind("Sliverlight:StartSelectFiles",function(e){var t,n;t=u.getElementById(s.settings.browse_button),n=e.settings.browse_button_active,t&&n&&g.removeClass(t,n)}),s.bind("Destroy",function(e){var t;g.removeAllEvents(u.body,e.id),delete f[e.id],delete p[e.id],(t=u.getElementById(e.id+"_silverlight_container"))&&l.removeChild(t)}),e({success:!0}))})}function d(){return u.getElementById(s.id+"_silverlight").content.Upload}}})}(window,document,plupload),function(e,d,u,t){var g={},c={};u.flash={trigger:function(t,n,i){setTimeout(function(){var e=g[t];e&&e.trigger("Flash:"+n,i)},0)}},u.runtimes.Flash=u.addRuntime("flash",{getFeatures:function(){return{jpgresize:!0,pngresize:!0,maxWidth:8091,maxHeight:8091,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(o,t){var e,n,i,r=0,a=d.body;(function(){var t;try{t=(t=navigator.plugins["Shockwave Flash"]).description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){t="0.0"}}return t=t.match(/\d+/g),parseFloat(t[0]+"."+t[1])})()<10?t({success:!1}):(c[o.id]=!1,g[o.id]=o,d.getElementById(o.settings.browse_button),(e=d.createElement("div")).id=o.id+"_flash_container",u.extend(e.style,{position:"absolute",top:"0px",background:o.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"}),e.className="plupload flash",o.settings.container&&(a=d.getElementById(o.settings.container),"static"===u.getStyle(a,"position")&&(a.style.position="relative")),a.appendChild(e),n='<object id="'+o.id+'_flash" type="application/x-shockwave-flash" data="'+o.settings.flash_swf_url+'" ',u.ua.ie&&(n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),n+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+o.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(o.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',u.ua.ie?(i=d.createElement("div"),e.appendChild(i),i.outerHTML=n,i=null):e.innerHTML=n,function e(){5e3<r++?t({success:!1}):c[o.id]||setTimeout(e,1)}(),e=null,o.bind("Flash:Init",function(){var s={};l().setFileFilters(o.settings.filters,o.settings.multi_selection),c[o.id]||(c[o.id]=!0,o.bind("UploadFile",function(e,t){var n=e.settings,i=o.settings.resize||{};l().uploadFile(s[t.id],n.url,{name:t.target_name||t.name,mime:u.mimeTypes[t.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:n.chunk_size,width:i.width,height:i.height,quality:i.quality,multipart:n.multipart,multipart_params:n.multipart_params||{},file_data_name:n.file_data_name,format:/\.(jpg|jpeg)$/i.test(t.name)?"jpg":"png",headers:n.headers,urlstream_upload:n.urlstream_upload})}),o.bind("Flash:UploadProcess",function(e,t){var n=e.getFile(s[t.id]);n.status!=u.FAILED&&(n.loaded=t.loaded,n.size=t.size,e.trigger("UploadProgress",n))}),o.bind("Flash:UploadChunkComplete",function(e,t){var n,i=e.getFile(s[t.id]);n={chunk:t.chunk,chunks:t.chunks,response:t.text},e.trigger("ChunkUploaded",i,n),i.status!=u.FAILED&&l().uploadNextChunk(),t.chunk==t.chunks-1&&(i.status=u.DONE,e.trigger("FileUploaded",i,{response:t.text}))}),o.bind("Flash:SelectFiles",function(e,t){var n,i,r,a=[];for(i=0;i<t.length;i++)n=t[i],r=u.guid(),s[r]=n.id,s[n.id]=r,a.push(new u.File(r,n.name,n.size));a.length&&o.trigger("FilesAdded",a)}),o.bind("Flash:SecurityError",function(e,t){o.trigger("Error",{code:u.SECURITY_ERROR,message:u.translate("Security error."),details:t.message,file:o.getFile(s[t.id])})}),o.bind("Flash:GenericError",function(e,t){o.trigger("Error",{code:u.GENERIC_ERROR,message:u.translate("Generic error."),details:t.message,file:o.getFile(s[t.id])})}),o.bind("Flash:IOError",function(e,t){o.trigger("Error",{code:u.IO_ERROR,message:u.translate("IO error."),details:t.message,file:o.getFile(s[t.id])})}),o.bind("Flash:ImageError",function(e,t){o.trigger("Error",{code:parseInt(t.code,10),message:u.translate("Image error."),file:o.getFile(s[t.id])})}),o.bind("Flash:StageEvent:rollOver",function(e){var t,n;t=d.getElementById(o.settings.browse_button),n=e.settings.browse_button_hover,t&&n&&u.addClass(t,n)}),o.bind("Flash:StageEvent:rollOut",function(e){var t,n;t=d.getElementById(o.settings.browse_button),n=e.settings.browse_button_hover,t&&n&&u.removeClass(t,n)}),o.bind("Flash:StageEvent:mouseDown",function(e){var t,n;t=d.getElementById(o.settings.browse_button),n=e.settings.browse_button_active,t&&n&&(u.addClass(t,n),u.addEvent(d.body,"mouseup",function(){u.removeClass(t,n)},e.id))}),o.bind("Flash:StageEvent:mouseUp",function(e){var t,n;t=d.getElementById(o.settings.browse_button),n=e.settings.browse_button_active,t&&n&&u.removeClass(t,n)}),o.bind("Flash:ExifData",function(e,t){o.trigger("ExifData",o.getFile(s[t.id]),t.data)}),o.bind("Flash:GpsData",function(e,t){o.trigger("GpsData",o.getFile(s[t.id]),t.data)}),o.bind("QueueChanged",function(e){o.refresh()}),o.bind("FilesRemoved",function(e,t){var n;for(n=0;n<t.length;n++)l().removeFile(s[t[n].id])}),o.bind("StateChanged",function(e){o.refresh()}),o.bind("Refresh",function(e){var t,n,i;l().setFileFilters(o.settings.filters,o.settings.multi_selection),(t=d.getElementById(e.settings.browse_button))&&(n=u.getPos(t,d.getElementById(e.settings.container)),i=u.getSize(t),u.extend(d.getElementById(e.id+"_flash_container").style,{top:n.y+"px",left:n.x+"px",width:i.w+"px",height:i.h+"px"}))}),o.bind("Destroy",function(e){var t;u.removeAllEvents(d.body,e.id),delete c[e.id],delete g[e.id],(t=d.getElementById(e.id+"_flash_container"))&&a.removeChild(t)}),t({success:!0}))}));function l(){return d.getElementById(o.id+"_flash")}}})}(window,document,plupload),function(p){p.runtimes.BrowserPlus=p.addRuntime("browserplus",{getFeatures:function(){return{dragdrop:!0,jpgresize:!0,pngresize:!0,chunks:!0,progress:!0,multipart:!0,multi_selection:!0}},init:function(a,n){var g=window.BrowserPlus,c={},s=a.settings,i=s.resize;function o(e){var t,n,i,r=[];for(t=0;t<e.length;t++)n=e[t],i=p.guid(),c[i]=n,r.push(new p.File(i,n.name,n.size));t&&a.trigger("FilesAdded",r)}g?g.init(function(e){var t=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"},{service:"FileAccess",version:"2"}];i&&t.push({service:"ImageAlter",version:"4"}),e.success?g.require({services:t},function(e){e.success?(a.bind("PostInit",function(){var e,i=s.drop_element,r=a.id+"_droptarget",t=document.getElementById(i);function n(t,n){g.DragAndDrop.AddDropTarget({id:t},function(e){g.DragAndDrop.AttachCallbacks({id:t,hover:function(e){!e&&n&&n()},drop:function(e){n&&n(),o(e)}},function(){})})}t&&(document.attachEvent&&/MSIE/gi.test(navigator.userAgent)?((e=document.createElement("div")).setAttribute("id",r),p.extend(e.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0}),document.body.appendChild(e),p.addEvent(t,"dragenter",function(e){var t,n;t=document.getElementById(i),n=p.getPos(t),p.extend(document.getElementById(r).style,{top:n.y+"px",left:n.x+"px",width:t.offsetWidth+"px",height:t.offsetHeight+"px"})}),n(r,function(){document.getElementById(r).style.top="-1000px"})):n(i)),p.addEvent(document.getElementById(s.browse_button),"click",function(e){var t,n,i,r=[],a=s.filters;e.preventDefault();e:for(t=0;t<a.length;t++)for(i=a[t].extensions.split(","),n=0;n<i.length;n++){if("*"===i[n]){r=[];break e}r.push(p.mimeTypes[i[n]])}g.FileBrowse.OpenBrowseDialog({mimeTypes:r},function(e){e.success&&o(e.value)})}),t=e=null}),a.bind("UploadFile",function(a,s){var o,e=c[s.id],t={},l=a.settings.chunk_size,d=[];function u(i,n){var r;s.status!=p.FAILED&&(t.name=s.target_name||s.name,l&&(t.chunk=""+i,t.chunks=""+n),r=d.shift(),g.Uploader.upload({url:a.settings.url,files:{file:r},cookies:document.cookies,postvars:p.extend(t,a.settings.multipart_params),progressCallback:function(e){var t,n=0;for(o[i]=parseInt(e.filePercent*r.size/100,10),t=0;t<o.length;t++)n+=o[t];s.loaded=n,a.trigger("UploadProgress",s)}},function(e){var t;e.success?(t=e.value.statusCode,l&&a.trigger("ChunkUploaded",s,{chunk:i,chunks:n,response:e.value.body,status:t}),0<d.length?u(++i,n):(s.status=p.DONE,a.trigger("FileUploaded",s,{response:e.value.body,status:t}),400<=t&&a.trigger("Error",{code:p.HTTP_ERROR,message:p.translate("HTTP Error."),file:s,status:t}))):a.trigger("Error",{code:p.GENERIC_ERROR,message:p.translate("Generic Error."),file:s,details:e.error})}))}function n(e){s.size=e.size,l?g.FileAccess.chunk({file:e,chunkSize:l},function(e){if(e.success){var t=e.value,n=t.length;o=Array(n);for(var i=0;i<n;i++)o[i]=0,d.push(t[i]);u(0,n)}}):(o=Array(1),d.push(e),u(0,1))}i&&/\.(png|jpg|jpeg)$/i.test(s.name)?BrowserPlus.ImageAlter.transform({file:e,quality:i.quality||90,actions:[{scale:{maxwidth:i.width,maxheight:i.height}}]},function(e){e.success&&n(e.value.file)}):n(e)}),n({success:!0})):n()}):n()}):n()}})}(plupload),function(F,m,x,h){var o,v={};function r(s,o,l,d){var u,g,c,p,f=this;!function(e,t){var n;if(!("FileReader"in F))return t(e.getAsDataURL());(n=new FileReader).readAsDataURL(e),n.onload=function(){t(n.result)}}(v[s.id],function(a){(u=m.createElement("canvas")).style.display="none",m.body.appendChild(u),g=u.getContext("2d"),(c=new Image).onerror=c.onabort=function(){d({success:!1})},c.onload=function(){var e,t,n,r;if(o.width||(o.width=c.width),o.height||(o.height=c.height),(p=Math.min(o.width/c.width,o.height/c.height))<1||1===p&&"image/jpeg"===l){if(e=Math.round(c.width*p),t=Math.round(c.height*p),u.width=e,u.height=t,g.drawImage(c,0,0,e,t),"image/jpeg"===l){if((n=new function a(e){var s,o,t,n={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},l=[],i=h,r=0;s=new b;s.init(e);if(65496!==s.SHORT(0))return;o=2;t=Math.min(1048576,e.length);for(;o<=t;)if(65488<=(i=s.SHORT(o))&&i<=65495)o+=2;else{if(65498===i||65497===i)break;r=s.SHORT(o+2)+2,n[i]&&s.STRING(o+4,n[i].signature.length)===n[i].signature&&l.push({hex:i,app:n[i].app.toUpperCase(),name:n[i].name.toUpperCase(),start:o,length:r,segment:s.SEGMENT(o,r)}),o+=r}s.init(null);return{headers:l,restore:function(e){s.init(e);var t=new a(e);if(!t.headers)return!1;for(var n=t.headers.length;0<n;n--){var i=t.headers[n-1];s.SEGMENT(i.start,i.length,"")}t.purge(),o=65504==s.SHORT(2)?4+s.SHORT(4):2;for(var n=0,r=l.length;n<r;n++)s.SEGMENT(o,0,l[n].segment),o+=l[n].length;return s.SEGMENT()},get:function(e){for(var t=[],n=0,i=l.length;n<i;n++)l[n].app===e.toUpperCase()&&t.push(l[n].segment);return t},set:function(e,t){var n=[];"string"==typeof t?n.push(t):n=t;for(var i=ii=0,r=l.length;i<r&&(l[i].app===e.toUpperCase()&&(l[i].segment=n[ii],l[i].length=n[ii].length,ii++),!(ii>=n.length));i++);},purge:function(){l=[],s.init(null)}}}(atob(a.substring(a.indexOf("base64,")+7)))).headers&&n.headers.length&&(r=new function(){var c,d,p,f={};function r(e,t){var n,i,r,a,s,o,l,d=c.SHORT(e),u=[],g={};for(n=0;n<d;n++)if(o=e+12*n+2,(r=t[c.SHORT(o)])!==h){switch(a=c.SHORT(o+=2),s=c.LONG(o+=2),o+=4,u=[],a){case 1:case 7:for(4<s&&(o=c.LONG(o)+f.tiffHeader),i=0;i<s;i++)u[i]=c.BYTE(o+i);break;case 2:4<s&&(o=c.LONG(o)+f.tiffHeader),g[r]=c.STRING(o,s-1);continue;case 3:for(2<s&&(o=c.LONG(o)+f.tiffHeader),i=0;i<s;i++)u[i]=c.SHORT(o+2*i);break;case 4:for(1<s&&(o=c.LONG(o)+f.tiffHeader),i=0;i<s;i++)u[i]=c.LONG(o+4*i);break;case 5:for(o=c.LONG(o)+f.tiffHeader,i=0;i<s;i++)u[i]=c.LONG(o+4*i)/c.LONG(o+4*i+4);break;case 9:for(o=c.LONG(o)+f.tiffHeader,i=0;i<s;i++)u[i]=c.SLONG(o+4*i);break;case 10:for(o=c.LONG(o)+f.tiffHeader,i=0;i<s;i++)u[i]=c.SLONG(o+4*i)/c.SLONG(o+4*i+4);break;default:continue}l=1==s?u[0]:u,p.hasOwnProperty(r)&&"object"!=typeof l?g[r]=p[r][l]:g[r]=l}return g}return c=new b,d={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},p={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return f={tiffHeader:10},!(e===h||!e.length||(c.init(e),65505!==c.SHORT(0)||"EXIF\0"!==c.STRING(4,5).toUpperCase()||(t=h,n=f.tiffHeader,c.II(18761==c.SHORT(n)),42!==c.SHORT(n+=2)||(f.IFD0=f.tiffHeader+c.LONG(n+=2),t=r(f.IFD0,d.tiff),f.exifIFD="ExifIFDPointer"in t?f.tiffHeader+t.ExifIFDPointer:h,f.gpsIFD="GPSInfoIFDPointer"in t?f.tiffHeader+t.GPSInfoIFDPointer:h,0))));var t,n},EXIF:function(){var e;return(e=r(f.exifIFD,d.exif)).ExifVersion&&(e.ExifVersion=String.fromCharCode(e.ExifVersion[0],e.ExifVersion[1],e.ExifVersion[2],e.ExifVersion[3])),e},GPS:function(){var e;return(e=r(f.gpsIFD,d.gps)).GPSVersionID&&(e.GPSVersionID=e.GPSVersionID.join(".")),e},setExif:function(e,t){return("PixelXDimension"===e||"PixelYDimension"===e)&&function(e,t,n){var r,a,s,o=0;if("string"==typeof t){var l=d[e.toLowerCase()];for(hex in l)if(l[hex]===t){t=hex;break}}for(r=f[e.toLowerCase()+"IFD"],a=c.SHORT(r),i=0;i<a;i++)if(s=r+12*i+2,c.SHORT(s)==t){o=s+8;break}return!!o&&(c.LONG(o,n),!0)}("exif",e,t)},getBinary:function(){return c.SEGMENT()}}}).init(n.get("exif")[0])&&(r.setExif("PixelXDimension",e),r.setExif("PixelYDimension",t),n.set("exif",r.getBinary()),f.hasEventListener("ExifData")&&f.trigger("ExifData",s,r.EXIF()),f.hasEventListener("GpsData")&&f.trigger("GpsData",s,r.GPS())),o.quality)try{a=u.toDataURL(l,o.quality/100)}catch(e){a=u.toDataURL(l)}}else a=u.toDataURL(l);a=a.substring(a.indexOf("base64,")+7),a=atob(a),n&&n.headers&&n.headers.length&&(a=n.restore(a),n.purge()),u.parentNode.removeChild(u),d({success:!0,data:a})}else d({success:!1})},c.src=a})}function b(){var a,s=!1;function i(e,t){var n,i=s?0:-8*(t-1),r=0;for(n=0;n<t;n++)r|=a.charCodeAt(e+n)<<Math.abs(i+8*n);return r}function o(e,t,n){n=3===arguments.length?n:a.length-t-1;a=a.substr(0,t)+e+a.substr(n+t)}return{II:function(e){if(e===h)return s;s=e},init:function(e){s=!1,a=e},SEGMENT:function(e,t,n){switch(arguments.length){case 1:return a.substr(e,a.length-e-1);case 2:return a.substr(e,t);case 3:o(n,e,t);break;default:return a}},BYTE:function(e){return i(e,1)},SHORT:function(e){return i(e,2)},LONG:function(e,t){if(t===h)return i(e,4);!function(e,t,n){var i,r="",a=s?0:-8*(n-1);for(i=0;i<n;i++)r+=String.fromCharCode(t>>Math.abs(a+8*i)&255);o(r,e,n)}(e,t,4)},SLONG:function(e){var t=i(e,4);return 2147483647<t?t-4294967296:t},STRING:function(e,t){var n="";for(t+=e;e<t;e++)n+=String.fromCharCode(i(e,1));return n}}}x.runtimes.Html5=x.addRuntime("html5",{getFeatures:function(){var e,t,n,i,r,a,s;return t=n=r=a=!1,F.XMLHttpRequest&&(n=!!(e=new XMLHttpRequest).upload,t=!(!e.sendAsBinary&&!e.upload)),t&&(i=!!(e.sendAsBinary||F.Uint8Array&&F.ArrayBuffer),r=!(!File||!File.prototype.getAsDataURL&&!F.FileReader||!i),a=!(!File||!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice))),o=x.ua.safari&&x.ua.windows,{html5:t,dragdrop:(s=m.createElement("div"),"draggable"in s||"ondragstart"in s&&"ondrop"in s),jpgresize:r,pngresize:r,multipart:r||!!F.FileReader||!!F.FormData,canSendBinary:i,cantSendBlobInFormData:!(!(x.ua.gecko&&F.FormData&&F.FileReader)||FileReader.prototype.readAsArrayBuffer),progress:n,chunks:a,multi_selection:!(x.ua.safari&&x.ua.windows),triggerDialog:x.ua.gecko&&F.FormData||x.ua.webkit}},init:function(f,e){var w;function h(e){var t,n,i,r=[],a={};for(n=0;n<e.length;n++)a[(t=e[n]).name]||(a[t.name]=!0,i=x.guid(),v[i]=t,r.push(new x.File(i,t.fileName||t.name,t.fileSize||t.size)));r.length&&f.trigger("FilesAdded",r)}(w=this.getFeatures()).html5?(f.bind("Init",function(t){var e,n,i,r,a,s,o,l=[],d=t.settings.filters,u=m.body;(e=m.createElement("div")).id=t.id+"_html5_container",x.extend(e.style,{position:"absolute",background:f.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:f.settings.shim_bgcolor?"":0}),e.className="plupload html5",f.settings.container&&(u=m.getElementById(f.settings.container),"static"===x.getStyle(u,"position")&&(u.style.position="relative")),u.appendChild(e);e:for(i=0;i<d.length;i++)for(a=d[i].extensions.split(/,/),r=0;r<a.length;r++){if("*"===a[r]){l=[];break e}(s=x.mimeTypes[a[r]])&&l.push(s)}if(e.innerHTML='<input id="'+f.id+'_html5"  style="font-size:999px" type="file" accept="'+l.join(",")+'" '+(f.settings.multi_selection&&f.features.multi_selection?'multiple="multiple"':"")+" />",e.scrollTop=100,o=m.getElementById(f.id+"_html5"),t.features.triggerDialog?x.extend(o.style,{position:"absolute",width:"100%",height:"100%"}):x.extend(o.style,{cssFloat:"right",styleFloat:"right"}),o.onchange=function(){h(this.files),this.value=""},n=m.getElementById(t.settings.browse_button)){var g=t.settings.browse_button_hover,c=t.settings.browse_button_active,p=t.features.triggerDialog?n:e;g&&(x.addEvent(p,"mouseover",function(){x.addClass(n,g)},t.id),x.addEvent(p,"mouseout",function(){x.removeClass(n,g)},t.id)),c&&(x.addEvent(p,"mousedown",function(){x.addClass(n,c)},t.id),x.addEvent(m.body,"mouseup",function(){x.removeClass(n,c)},t.id)),t.features.triggerDialog&&x.addEvent(n,"click",function(e){m.getElementById(t.id+"_html5").click(),e.preventDefault()},t.id)}}),f.bind("PostInit",function(){var i=m.getElementById(f.settings.drop_element);if(i){if(o)return void x.addEvent(i,"dragenter",function(e){var t,n;(t=m.getElementById(f.id+"_drop"))||((t=m.createElement("input")).setAttribute("type","file"),t.setAttribute("id",f.id+"_drop"),t.setAttribute("multiple","multiple"),x.addEvent(t,"change",function(){h(this.files),x.removeEvent(t,"change",f.id),t.parentNode.removeChild(t)},f.id),i.appendChild(t)),x.getPos(i,m.getElementById(f.settings.container)),n=x.getSize(i),"static"===x.getStyle(i,"position")&&x.extend(i.style,{position:"relative"}),x.extend(t.style,{position:"absolute",display:"block",top:0,left:0,width:n.w+"px",height:n.h+"px",opacity:0})},f.id);x.addEvent(i,"dragover",function(e){e.preventDefault()},f.id),x.addEvent(i,"drop",function(e){var t=e.dataTransfer;t&&t.files&&h(t.files),e.preventDefault()},f.id)}}),f.bind("Refresh",function(e){var t,n,i,r,a;(t=m.getElementById(f.settings.browse_button))&&(n=x.getPos(t,m.getElementById(e.settings.container)),i=x.getSize(t),r=m.getElementById(f.id+"_html5_container"),x.extend(r.style,{top:n.y+"px",left:n.x+"px",width:i.w+"px",height:i.h+"px"}),f.features.triggerDialog&&("static"===x.getStyle(t,"position")&&x.extend(t.style,{position:"relative"}),a=parseInt(x.getStyle(t,"z-index"),10),isNaN(a)&&(a=0),x.extend(t.style,{zIndex:a}),x.extend(r.style,{zIndex:a-1})))}),f.bind("UploadFile",function(y,_){var t,i=y.settings;function n(t){var b=0,E=0,n="FileReader"in F?new FileReader:null;!function u(){var g,c,p,f,h,m,v=y.settings.url;function e(n){var i,t=0,r=new XMLHttpRequest,e=r.upload,a="----pluploadboundary"+x.guid(),s="\r\n",o="";if(e&&(e.onprogress=function(e){_.loaded=Math.min(_.size,E+e.loaded-t),y.trigger("UploadProgress",_)}),r.onreadystatechange=function(){var t,e;if(4==r.readyState){try{t=r.status}catch(e){t=0}if(400<=t)y.trigger("Error",{code:x.HTTP_ERROR,message:x.translate("HTTP Error."),file:_,status:t});else{if(c){if(e={chunk:b,chunks:c,response:r.responseText,status:t},y.trigger("ChunkUploaded",_,e),E+=h,e.cancelled)return void(_.status=x.FAILED);_.loaded=Math.min(_.size,(b+1)*f)}else _.loaded=_.size;y.trigger("UploadProgress",_),n=g=i=o=null,!c||++b>=c?(_.status=x.DONE,y.trigger("FileUploaded",_,{response:r.responseText,status:t})):u()}r=null}},y.settings.multipart&&w.multipart){if(p.name=_.target_name||_.name,r.open("post",v,!0),x.each(y.settings.headers,function(e,t){r.setRequestHeader(t,e)}),"string"!=typeof n&&F.FormData)return i=new FormData,x.each(x.extend(p,y.settings.multipart_params),function(e,t){i.append(t,e)}),i.append(y.settings.file_data_name,n),void r.send(i);if("string"==typeof n){if(r.setRequestHeader("Content-Type","multipart/form-data; boundary="+a),x.each(x.extend(p,y.settings.multipart_params),function(e,t){o+="--"+a+s+'Content-Disposition: form-data; name="'+t+'"'+s+s,o+=unescape(encodeURIComponent(e))+s}),m=x.mimeTypes[_.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",o+="--"+a+s+'Content-Disposition: form-data; name="'+y.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(_.name))+'"'+s+"Content-Type: "+m+s+s+n+s+"--"+a+"--"+s,t=o.length-n.length,n=o,r.sendAsBinary)r.sendAsBinary(n);else if(w.canSendBinary){for(var l=new Uint8Array(n.length),d=0;d<n.length;d++)l[d]=255&n.charCodeAt(d);r.send(l.buffer)}return}}v=x.buildUrl(y.settings.url,x.extend(p,y.settings.multipart_params)),r.open("post",v,!0),r.setRequestHeader("Content-Type","application/octet-stream"),x.each(y.settings.headers,function(e,t){r.setRequestHeader(t,e)}),r.send(n)}_.status!=x.DONE&&_.status!=x.FAILED&&y.state!=x.STOPPED&&(p={name:_.target_name||_.name},i.chunk_size&&_.size>i.chunk_size&&(w.chunks||"string"==typeof t)?(f=i.chunk_size,c=Math.ceil(_.size/f),h=Math.min(f,_.size-b*f),g="string"==typeof t?t.substring(b*f,b*f+h):function(t,n,i){var e;if(!File.prototype.slice)return(e=File.prototype.webkitSlice||File.prototype.mozSlice)?e.call(t,n,i):null;try{return t.slice(),t.slice(n,i)}catch(e){return t.slice(n,i-n)}}(t,b*f,b*f+h),p.chunk=b,p.chunks=c):(h=_.size,g=t),"string"!=typeof g&&n&&w.cantSendBlobInFormData&&w.chunks&&y.settings.chunk_size?(n.onload=function(){e(n.result)},n.readAsBinaryString(g)):e(g))}()}t=v[_.id],w.jpgresize&&y.settings.resize&&/\.(png|jpg|jpeg)$/i.test(_.name)?r.call(y,_,y.settings.resize,/\.png$/i.test(_.name)?"image/png":"image/jpeg",function(e){e.success?(_.size=e.data.length,n(e.data)):n(t)}):!w.chunks&&w.jpgresize?function(e,t){var n;if(!("FileReader"in F))return t(e.getAsBinary());(n=new FileReader).readAsBinaryString(e),n.onload=function(){t(n.result)}}(t,n):n(t)}),f.bind("Destroy",function(e){var t,n,i=m.body,r={inputContainer:e.id+"_html5_container",inputFile:e.id+"_html5",browseButton:e.settings.browse_button,dropElm:e.settings.drop_element};for(t in r)(n=m.getElementById(r[t]))&&x.removeAllEvents(n,e.id);x.removeAllEvents(m.body,e.id),e.settings.container&&(i=m.getElementById(e.settings.container)),i.removeChild(m.getElementById(r.inputContainer))}),e({success:!0})):e({success:!1})}})}(window,document,plupload),function(h,m,v,e){function b(e){return m.getElementById(e)}v.runtimes.Html4=v.addRuntime("html4",{getFeatures:function(){return{multipart:!0,triggerDialog:v.ua.gecko&&h.FormData||v.ua.webkit}},init:function(f,e){f.bind("Init",function(l){var n,r,d,e,t,i,a,u=m.body,s="javascript",g=[],c=/MSIE/.test(navigator.userAgent),p=[],o=l.settings.filters;e:for(e=0;e<o.length;e++)for(t=o[e].extensions.split(/,/),a=0;a<t.length;a++){if("*"===t[a]){p=[];break e}(i=v.mimeTypes[t[a]])&&p.push(i)}p=p.join(","),l.settings.container&&(u=b(l.settings.container),"static"===v.getStyle(u,"position")&&(u.style.position="relative")),l.bind("UploadFile",function(e,t){var i;t.status!=v.DONE&&t.status!=v.FAILED&&e.state!=v.STOPPED&&(i=b("form_"+t.id),b("input_"+t.id).setAttribute("name",e.settings.file_data_name),i.setAttribute("action",e.settings.url),v.each(v.extend({name:t.target_name||t.name},e.settings.multipart_params),function(e,t){var n=m.createElement("input");v.extend(n,{type:"hidden",name:t,value:e}),i.insertBefore(n,i.firstChild)}),r=t,b("form_"+d).style.top="-1048575px",i.submit(),i.parentNode.removeChild(i))}),l.bind("FileUploaded",function(e){e.refresh()}),l.bind("StateChanged",function(e){var t;e.state==v.STARTED&&((t=m.createElement("div")).innerHTML='<iframe id="'+l.id+'_iframe" name="'+l.id+'_iframe" src="'+s+':&quot;&quot;" style="display:none"></iframe>',n=t.firstChild,u.appendChild(n),v.addEvent(n,"load",function(e){var t,n,i=e.target;if(r){try{t=i.contentWindow.document||i.contentDocument||h.frames[i.id].document}catch(e){return void l.trigger("Error",{code:v.SECURITY_ERROR,message:v.translate("Security error."),file:r})}(n=t.body.innerHTML)&&(r.status=v.DONE,r.loaded=1025,r.percent=100,l.trigger("UploadProgress",r),l.trigger("FileUploaded",r,{response:n}))}},l.id)),e.state==v.STOPPED&&h.setTimeout(function(){v.removeEvent(n,"load",e.id),n.parentNode&&n.parentNode.removeChild(n)},0)}),l.bind("Refresh",function(e){var t,n,i,r,a,s,o,l;(t=b(e.settings.browse_button))&&(a=v.getPos(t,b(e.settings.container)),s=v.getSize(t),o=b("form_"+d),b("input_"+d),v.extend(o.style,{top:a.y+"px",left:a.x+"px",width:s.w+"px",height:s.h+"px"}),e.features.triggerDialog&&("static"===v.getStyle(t,"position")&&v.extend(t.style,{position:"relative"}),l=parseInt(t.style.zIndex,10),isNaN(l)&&(l=0),v.extend(t.style,{zIndex:l}),v.extend(o.style,{zIndex:l-1})),i=e.settings.browse_button_hover,r=e.settings.browse_button_active,n=e.features.triggerDialog?t:o,i&&(v.addEvent(n,"mouseover",function(){v.addClass(t,i)},e.id),v.addEvent(n,"mouseout",function(){v.removeClass(t,i)},e.id)),r&&(v.addEvent(n,"mousedown",function(){v.addClass(t,r)},e.id),v.addEvent(m.body,"mouseup",function(){v.removeClass(t,r)},e.id)))}),f.bind("FilesRemoved",function(e,t){var n,i;for(n=0;n<t.length;n++)(i=b("form_"+t[n].id))&&i.parentNode.removeChild(i)}),f.bind("Destroy",function(e){var t,n,i,r={inputContainer:"form_"+d,inputFile:"input_"+d,browseButton:e.settings.browse_button};for(t in r)(n=b(r[t]))&&v.removeAllEvents(n,e.id);v.removeAllEvents(m.body,e.id),v.each(g,function(e,t){(i=b("form_"+e))&&u.removeChild(i)})}),function r(){var a,s,e,o;d=v.guid(),g.push(d),(a=m.createElement("form")).setAttribute("id","form_"+d),a.setAttribute("method","post"),a.setAttribute("enctype","multipart/form-data"),a.setAttribute("encoding","multipart/form-data"),a.setAttribute("target",l.id+"_iframe"),a.style.position="absolute",(s=m.createElement("input")).setAttribute("id","input_"+d),s.setAttribute("type","file"),s.setAttribute("accept",p),s.setAttribute("size",1),o=b(l.settings.browse_button),l.features.triggerDialog&&o&&v.addEvent(b(l.settings.browse_button),"click",function(e){s.click(),e.preventDefault()},l.id),v.extend(s.style,{width:"100%",height:"100%",opacity:0,fontSize:"999px"}),v.extend(a.style,{overflow:"hidden"}),(e=l.settings.shim_bgcolor)&&(a.style.background=e),c&&v.extend(s.style,{filter:"alpha(opacity=0)"}),v.addEvent(s,"change",function(e){var t,n=e.target,i=[];n.value&&(b("form_"+d).style.top="-1048575px",t=(t=n.value.replace(/\\/g,"/")).substring(t.length,t.lastIndexOf("/")+1),i.push(new v.File(d,t)),l.features.triggerDialog?v.removeEvent(o,"click",l.id):v.removeAllEvents(a,l.id),v.removeEvent(s,"change",l.id),r(),i.length&&f.trigger("FilesAdded",i))},l.id),a.appendChild(s),u.appendChild(a),l.refresh()}()}),e({success:!0})}})}(window,document,plupload);