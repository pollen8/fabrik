/*! Fabrik */

define(["jquery","fab/element"],function(t,i){return window.FbTimer=new Class({options:{defaultVal:"",editable:!1,startCrono:"15:00",endCrono:"00:00",div:!1,stopOnComplete:!0,onComplete:function(){},onEveryMinute:function(){},onEveryHour:function(){}},Extends:i,initialize:function(t,i){this.setPlugin("fabriktimer"),this.parent(t,i);var s=document.id(this.options.element+"_button");this.seg=0,this.min=0,!(this.hour=0)===this.options.autostart?("null"!==typeOf(s)&&s.getElement("span").set("text",Joomla.JText._("PLG_ELEMENT_TIMER_STOP")),this.start()):this.state="paused",this.incremental=1,"null"!==typeOf(s)&&s.addEvent("click",function(t){if(t.stop(),"started"===this.state)this.pause(),s.getElement("span").set("text",Joomla.JText._("PLG_ELEMENT_TIMER_START"));else{var i=this.element.value.split(":");switch(i.length){case 3:this.hour=""===i[0]?0:i[0].toInt(),this.min=""===i[1]?0:i[1].toInt(),this.seg=""===i[2]?0:i[2].toInt();break;case 2:this.min=""===i[0]?0:i[0].toInt(),this.seg=""===i[1]?0:i[1].toInt();break;case 1:this.seg=""===i[0]?0:i[0].toInt()}this.start(),s.getElement("span").set("text",Joomla.JText._("PLG_ELEMENT_TIMER_STOP"))}}.bind(this))},start:function(){"started"!==this.state&&(this.timer=this.count.periodical(1e3,this),this.state="started")},pause:function(){"paused"!==this.state&&(clearInterval(this.timer),this.state="paused")},count:function(){this.seg+=this.incremental,-1!==this.seg&&60!==this.seg||(this.seg=0<this.incremental?0:59,this.min+=this.incremental,-1!==this.min&&60!==this.min||(this.min=0<this.incremental?0:59,this.hour+=this.incremental)),this.element.value=this.time(),this.min===this.endMin&&this.seg===this.endSeg&&(this.fireEvent("onComplete",""),this.options.stopOnComplete&&this.pause())},time:function(){var t=this.hour<10?"0"+this.hour:this.hour;return t+=(this.min<10?":0":":")+this.min,t+=(this.seg<10?":0":":")+this.seg},reset:function(){var t=this.options.startCrono.split(":"),i=this.options.endCrono.split(":");this.startMin=t[0].toInt(),this.startSeg=t[1].toInt(),this.endMin=i[0].toInt(),this.endSeg=i[1].toInt(),this.endMin!==this.startMin?this.incremental=this.endMin>this.startMin?1:-1:this.incremental=this.endSeg>this.startSeg?1:-1,this.min=this.startMin,this.seg=this.startSeg,!1!==this.options.div&&document.id(this.options.div).set("text",this.time())}}),window.FbTimer});