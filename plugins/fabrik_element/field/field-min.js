/*! Fabrik */

function geolocateLoad(){document.body?window.fireEvent("google.geolocate.loaded"):console.log("no body")}define(["jquery","fab/element","components/com_fabrik/libs/masked_input/jquery.maskedinput"],function(o,e,t){return window.FbField=new Class({Extends:e,options:{use_input_mask:!1,input_mask_definitions:"",input_mask_autoclear:!1,geocomplete:!1,mapKey:!1,language:""},initialize:function(e,t){var i;this.setPlugin("fabrikfield"),this.parent(e,t),this.options.use_input_mask&&(""!==this.options.input_mask_definitions&&(i=JSON.parse(this.options.input_mask_definitions),o.extend(o.mask.definitions,i)),o("#"+e).mask(this.options.input_mask,{autoclear:this.options.input_mask_autoclear})),this.options.geocomplete&&(this.gcMade=!1,this.loadFn=function(){if(!1===this.gcMade){var i=this;o("#"+this.element.id).geocomplete({}).bind("geocode:result",function(e,t){Fabrik.fireEvent("fabrik.element.field.geocode",[i,t])}),this.gcMade=!0}}.bind(this),window.addEvent("google.geolocate.loaded",this.loadFn),Fabrik.loadGoogleMap(this.options.mapKey,"geolocateLoad",this.options.language)),this.options.editable&&this.options.scanQR&&(this.qrBtn=document.id(e+"_qr_upload"),this.qrBtn.addEvent("change",function(e){var t=e.target,i=new FileReader,n=this;i.onload=function(){t.value="",qrcode.callback=function(e){e instanceof Error?alert("No QR code found. Please make sure the QR code is within the camera's frame and try again."):n.update(e)}.bind(this),qrcode.decode(i.result)},i.readAsDataURL(t.files[0])}.bind(this)))},select:function(){this.getElement()&&this.getElement().select()},focus:function(){this.getElement()&&this.getElement().focus(),this.parent()},cloned:function(e){var t=this.getElement();if(this.options.use_input_mask&&t){if(""!==this.options.input_mask_definitions){var i=JSON.parse(this.options.input_mask_definitions);$H(i).each(function(e,t){o.mask.definitions[t]=e})}o("#"+t.id).mask(this.options.input_mask,{autoclear:this.options.input_mask_autoclear})}if(this.options.geocomplete&&t){var n=this;o("#"+this.element.id).geocomplete().bind("geocode:result",function(e,t){Fabrik.fireEvent("fabrik.element.field.geocode",[n,t])})}this.parent(e)}}),window.FbField});