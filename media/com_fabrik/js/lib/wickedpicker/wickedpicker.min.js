(function($,window,document){"use strict";if(typeof String.prototype.endsWith!="function"){String.prototype.endsWith=function(string){return string.length>0&&this.substring(this.length-string.length,this.length)===string}}var isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)};var today=new Date;var pluginName="wickedpicker",defaults={now:today.getHours()+":"+today.getMinutes(),twentyFour:false,upArrow:"wickedpicker__controls__control-up",downArrow:"wickedpicker__controls__control-down",close:"wickedpicker__close",hoverState:"hover-state",title:"Timepicker",showSeconds:false,timeSeparator:" : ",secondsInterval:1,minutesInterval:1,beforeShow:null,afterShow:null,show:null,clearable:false,closeOnClickOutside:true,onClickOutside:function(){}};function Wickedpicker(element,options){this.element=$(element);this.options=$.extend({},defaults,options);this.element.addClass("hasWickedpicker");this.element.attr("onkeypress","return false;");this.element.attr("aria-showingpicker","false");this.createPicker();this.timepicker=$(".wickedpicker");this.up=$("."+this.options.upArrow.split(/\s+/).join("."));this.down=$("."+this.options.downArrow.split(/\s+/).join("."));this.separator=$(".wickedpicker__controls__control--separator");this.hoursElem=$(".wickedpicker__controls__control--hours");this.minutesElem=$(".wickedpicker__controls__control--minutes");this.secondsElem=$(".wickedpicker__controls__control--seconds");this.meridiemElem=$(".wickedpicker__controls__control--meridiem");this.close=$("."+this.options.close.split(/\s+/).join("."));var time=this.timeArrayFromString(this.options.now);this.options.now=new Date(today.getFullYear(),today.getMonth(),today.getDate(),time[0],time[1],time[2]);this.selectedHour=this.parseHours(this.options.now.getHours());this.selectedMin=this.parseSecMin(this.options.now.getMinutes());this.selectedSec=this.parseSecMin(this.options.now.getSeconds());this.selectedMeridiem=this.parseMeridiem(this.options.now.getHours());this.setHoverState();this.attach(element);this.setText(element)}$.extend(Wickedpicker.prototype,{showPicker:function(element){if(typeof this.options.beforeShow==="function"){this.options.beforeShow(element,this.timepicker)}var timepickerPos=$(element).offset();$(element).attr({"aria-showingpicker":"true",tabindex:-1});this.setText(element);this.showHideSecondsControl();this.showHideMeridiemControl();if(this.getText(element)!==this.getTime()){var text=this.getText(element);var re=/\s[ap]m$/i;var meridiem=re.test(text)?text.substr(-2,2):null;var inputTime=text.replace(re,"").split(this.options.timeSeparator);var newTime={};newTime.hours=inputTime[0];newTime.minutes=inputTime[1];newTime.meridiem=meridiem;if(this.options.showSeconds){newTime.seconds=inputTime[2]}this.setTime(newTime)}this.timepicker.css({"z-index":1e4,position:"absolute",left:timepickerPos.left,top:timepickerPos.top+$(element)[0].offsetHeight}).show();if(typeof this.options.show==="function"){this.options.show(element,this.timepicker)}this.handleTimeAdjustments(element)},hideTimepicker:function(element){this.timepicker.hide();if(typeof this.options.afterShow==="function"){this.options.afterShow(element,this.timepicker)}var pickerHidden={start:function(){var setShowPickerFalse=$.Deferred();$('[aria-showingpicker="true"]').attr("aria-showingpicker","false");return setShowPickerFalse.promise()}};function setTabIndex(index){setTimeout(function(){$('[aria-showingpicker="false"]').attr("tabindex",index)},400)}pickerHidden.start().then(setTabIndex(0))},createPicker:function(){if($(".wickedpicker").length===0){var picker='<div class="wickedpicker"><p class="wickedpicker__title">'+this.options.title+'<span class="wickedpicker__close"></span></p><ul class="wickedpicker__controls"><li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--hours" tabindex="-1">00</span><span class="'+this.options.downArrow+'"></span></li><li class="wickedpicker__controls__control--separator"><span class="wickedpicker__controls__control--separator-inner">:</span></li><li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--minutes" tabindex="-1">00</span><span class="'+this.options.downArrow+'"></span></li>';picker+='<li class="wickedpicker__controls__control--separator"><span class="wickedpicker__controls__control--separator-inner">:</span></li><li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--seconds" tabindex="-1">00</span><span class="'+this.options.downArrow+'"></span> </li>';picker+='<li class="wickedpicker__controls__control"><span class="'+this.options.upArrow+'"></span><span class="wickedpicker__controls__control--meridiem" tabindex="-1">AM</span><span class="'+this.options.downArrow+'"></span></li></ul></div>';$("body").append(picker);this.attachKeyboardEvents()}},showHideMeridiemControl:function(){if(this.options.twentyFour===false){$(this.meridiemElem).parent().show()}else{$(this.meridiemElem).parent().hide()}},showHideSecondsControl:function(){if(this.options.showSeconds){$(this.secondsElem).parent().show();$(this.secondsElem).parent().prev(".wickedpicker__controls__control--separator").show()}else{$(this.secondsElem).parent().hide();$(this.secondsElem).parent().prev(".wickedpicker__controls__control--separator").hide()}},attach:function(element){var self=this;if(this.options.clearable){self.makePickerInputClearable(element)}$(element).attr("tabindex",0);$(element).on("click focus",function(event){if($(self.timepicker).is(":hidden")){self.showPicker($(this));window.lastTimePickerControl=$(this);$(self.hoursElem).focus()}});var clickHandler=function(event){if($(self.timepicker).is(":visible")){if($(event.target).is(self.close)){self.hideTimepicker(window.lastTimePickerControl)}else if($(event.target).closest(self.timepicker).length||$(event.target).closest($(".hasWickedpicker")).length){event.stopPropagation()}else{if(typeof self.options.onClickOutside==="function"){self.options.onClickOutside()}else{console.warn("Type of onClickOutside must be a function")}if(!self.options.closeOnClickOutside){return}self.hideTimepicker(window.lastTimePickerControl)}window.lastTimePickerControl=null}};$(document).off("click",clickHandler).on("click",clickHandler)},attachKeyboardEvents:function(){$(document).on("keydown",$.proxy(function(event){switch(event.keyCode){case 9:if(event.target.className!=="hasWickedpicker"){$(this.close).trigger("click")}break;case 27:$(this.close).trigger("click");break;case 37:if(event.target.className!==this.hoursElem[0].className){$(event.target).parent().prevAll("li").not(this.separator.selector).first().children()[1].focus()}else{$(event.target).parent().siblings(":last").children()[1].focus()}break;case 39:if(event.target.className!==this.meridiemElem[0].className){$(event.target).parent().nextAll("li").not(this.separator.selector).first().children()[1].focus()}else{$(event.target).parent().siblings(":first").children()[1].focus()}break;case 38:$(":focus").prev().trigger("click");break;case 40:$(":focus").next().trigger("click");break;default:break}},this))},setTime:function(time){this.setHours(time.hours);this.setMinutes(time.minutes);this.setMeridiem(time.meridiem);if(this.options.showSeconds){this.setSeconds(time.seconds)}},getTime:function(){return[this.formatTime(this.getHours(),this.getMinutes(),this.getMeridiem(),this.getSeconds())]},setHours:function(hours){var hour=new Date;hour.setHours(hours);var hoursText=this.parseHours(hour.getHours());this.hoursElem.text(hoursText);this.selectedHour=hoursText},getHours:function(){var hours=new Date;hours.setHours(this.hoursElem.text());return hours.getHours()},parseHours:function(hours){return this.options.twentyFour===false?(hours+11)%12+1:hours<10?"0"+hours:hours},setMinutes:function(minutes){var minute=new Date;minute.setMinutes(minutes);var minutesText=minute.getMinutes();var min=this.parseSecMin(minutesText);this.minutesElem.text(min);this.selectedMin=min},getMinutes:function(){var minutes=new Date;minutes.setMinutes(this.minutesElem.text());return minutes.getMinutes()},parseSecMin:function(value){return(value<10?"0":"")+value},setMeridiem:function(inputMeridiem){var newMeridiem="";if(inputMeridiem===undefined){var meridiem=this.getMeridiem();newMeridiem=meridiem==="PM"?"AM":"PM"}else{newMeridiem=inputMeridiem}this.meridiemElem.text(newMeridiem);this.selectedMeridiem=newMeridiem},getMeridiem:function(){return this.meridiemElem.text()},setSeconds:function(seconds){var second=new Date;second.setSeconds(seconds);var secondsText=second.getSeconds();var sec=this.parseSecMin(secondsText);this.secondsElem.text(sec);this.selectedSec=sec},getSeconds:function(){var seconds=new Date;seconds.setSeconds(this.secondsElem.text());return seconds.getSeconds()},parseMeridiem:function(hours){return hours>11?"PM":"AM"},handleTimeAdjustments:function(element){var timeOut=0;$(this.up).add(this.down).off("mousedown click touchstart").on("mousedown click",{Wickedpicker:this,input:element},function(event){if(event.which!=1)return false;var operator=this.className.indexOf("up")>-1?"+":"-";var passedData=event.data;if(event.type=="mousedown"){timeOut=setInterval($.proxy(function(args){args.Wickedpicker.changeValue(operator,args.input,this)},this,{Wickedpicker:passedData.Wickedpicker,input:passedData.input}),200)}else{passedData.Wickedpicker.changeValue(operator,passedData.input,this)}}).bind("mouseup touchend",function(){clearInterval(timeOut)})},changeValue:function(operator,input,clicked){var target=operator==="+"?clicked.nextSibling:clicked.previousSibling;var targetClass=$(target).attr("class");if(targetClass.endsWith("hours")){this.setHours(eval(this.getHours()+operator+1))}else if(targetClass.endsWith("minutes")){this.setMinutes(eval(this.getMinutes()+operator+this.options.minutesInterval))}else if(targetClass.endsWith("seconds")){this.setSeconds(eval(this.getSeconds()+operator+this.options.secondsInterval))}else{this.setMeridiem()}this.setText(input)},setText:function(input){$(input).val(this.formatTime(this.selectedHour,this.selectedMin,this.selectedMeridiem,this.selectedSec)).change()},getText:function(input){return $(input).val()},formatTime:function(hour,min,meridiem,seconds){var formattedTime=hour+this.options.timeSeparator+min;if(this.options.showSeconds){formattedTime+=this.options.timeSeparator+seconds}if(this.options.twentyFour===false){formattedTime+=" "+meridiem}return formattedTime},setHoverState:function(){var self=this;if(!isMobile()){$(this.up).add(this.down).add(this.close).hover(function(){$(this).toggleClass(self.options.hoverState)})}},makePickerInputClearable:function(input){$(input).wrap('<div class="clearable-picker"></div>').after("<span data-clear-picker>&times;</span>");$("[data-clear-picker]").on("click",function(event){$(this).siblings(".hasWickedpicker").val("")})},timeArrayFromString:function(stringTime){if(stringTime.length){var time=stringTime.split(":");time[2]=time.length<3?"00":time[2];return time}return false},_time:function(){var inputValue=$(this.element).val();return inputValue===""?this.formatTime(this.selectedHour,this.selectedMin,this.selectedMeridiem,this.selectedSec):inputValue},_hide:function(){this.hideTimepicker(this.element)}});$.fn[pluginName]=function(options,index){if(!$.isFunction(Wickedpicker.prototype["_"+options])){return this.each(function(){if(!$.data(this,"plugin_"+pluginName)){$.data(this,"plugin_"+pluginName,new Wickedpicker(this,options))}})}else if($(this).hasClass("hasWickedpicker")){if(index!==undefined){return $.data($(this)[index],"plugin_"+pluginName)["_"+options]()}else{return $.data($(this)[0],"plugin_"+pluginName)["_"+options]()}}}})(jQuery,window,document);