/*! Fabrik */

define(["jquery"],function(s){return new Class({initialize:function(){this.spinners={},this.spinnerCount={},this.watchResize()},sanitizeInline:function(n){return(n=n||document.body)instanceof s?n=0!==n.length&&n[0]:"null"===typeOf(document.id(n))&&(n=!1),n},start:function(n,i){if(n=this.sanitizeInline(n),i=i||Joomla.JText._("COM_FABRIK_LOADING"),this.spinners[n]||(this.spinners[n]=new Spinner(n,{message:i})),this.spinnerCount[n]?this.spinnerCount[n]++:this.spinnerCount[n]=1,1===this.spinnerCount[n])try{this.spinners[n].position().show()}catch(n){}},stop:function(n){if(n=this.sanitizeInline(n),this.spinners[n]&&this.spinnerCount[n])if(1<this.spinnerCount[n])this.spinnerCount[n]--;else{var i=this.spinners[n];Browser.ie&&Browser.version<9?i.hide():(i.destroy(),delete this.spinnerCount[n],delete this.spinners[n])}},watchResize:function(){var n=this;setInterval(function(){s.each(n.spinners,function(n,i){try{var t=Math.max(40,s(i.target).height()),e=s(i.target).width();s(i.element).height(t),0!==e&&(s(i.element).width(e),s(i.element).find(".spinner-content").css("left",e/2)),i.position()}catch(n){}})},300)}})});