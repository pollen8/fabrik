Request.HTML=new Class({Extends:Request,options:{update:false,append:false,evalScripts:true,filter:false,headers:{Accept:"text/html, application/xml, text/xml, */*"}},success:function(i){var j=this.options,d=this.response;var c=i.match(/<script[^>]*>([\s\S]*?)<\/script>/gi);var f=[];if(typeOf(c)!=="null"){for(var g=0;g<c.length;g++){if(c[g].contains('src="')){var b=c[g].match(/src=\"([\s\S]*?)\"/);if(b[1]){f.push(b[1])}}}var a="head.js('"+f.join("','")+"');\n";Browser.exec(a)}d.html=i.stripScripts(function(k){d.javascript=k});var e=d.html.match(/<body[^>]*>([\s\S]*?)<\/body>/i);if(e){d.html=e[1]}var h=new Element("div").set("html",d.html);d.tree=h.childNodes;d.elements=h.getElements("*");if(j.filter){d.tree=d.elements.filter(j.filter)}if(j.update){document.id(j.update).empty().set("html",d.html)}else{if(j.append){document.id(j.append).adopt(h.getChildren())}}if(j.evalScripts){Browser.exec(d.javascript)}this.onSuccess(d.tree,d.elements,d.html,d.javascript)}});Element.implement({keepCenter:function(){this.makeCenter();window.addEvent("scroll",function(){this.makeCenter()}.bind(this));window.addEvent("resize",function(){this.makeCenter()}.bind(this))},makeCenter:function(){var a=window.getWidth()/2-this.getWidth()/2;var b=window.getScrollTop()+(window.getHeight()/2-this.getHeight()/2);this.setStyles({left:a,top:b})}});var Loader=new Class({initialize:function(a){this.spinners={}},getSpinner:function(b,c){c=c?c:"loading";if(typeOf(document.id(b))==="null"){b=false}b=b?b:false;var a=b?b:document.body;if(!this.spinners[b]){this.spinners[b]=new Spinner(a,{message:c})}return this.spinners[b]},start:function(a,b){this.getSpinner(a,b).position().show()},stop:function(b,d,c){var a=this.getSpinner(b,d);if(Browser.ie&&Browser.version<9){a.clearChain();a.hide()}else{a.destroy()}delete this.spinners[b]}});(function(){if(typeof(Fabrik)==="undefined"){Fabrik={};Fabrik.events={};Fabrik.Windows={};Fabrik.loader=new Loader();Fabrik.blocks={};Fabrik.addBlock=function(a,b){Fabrik.blocks[a]=b;Fabrik.fireEvent("fabrik.block.added",b)};document.addEvent("click:relay(.fabrik_delete a)",function(b,a){Fabrik.watchDelete(b,a)});Fabrik.iconGen=new IconGenerator({scale:0.5});Fabrik.removeEvent=function(c,b){if(Fabrik.events[c]){var a=Fabrik.events[c].indexOf(b);if(a!==-1){delete Fabrik.events[c][a]}}};Fabrik.addEvent=function(b,a){if(!Fabrik.events[b]){Fabrik.events[b]=[]}if(!Fabrik.events[b].contains(a)){Fabrik.events[b].push(a)}};Fabrik.addEvents=function(a){for(var b in a){Fabrik.addEvent(b,a[b])}return this};Fabrik.fireEvent=function(d,b,a){var c=Fabrik.events;if(!c||!c[d]){return this}b=Array.from(b);c[d].each(function(e){if(a){e.delay(a,this,b)}else{e.apply(this,b)}},this);return this};Fabrik.watchDelete=function(f,d){var a,c,b;b=f.target.getParent(".fabrik_row");if(!b){b=Fabrik.activeRow}if(b){var g=b.getElement("input[type=checkbox][name*=id]");if(typeOf(g)!=="null"){g.checked=true}c=b.id.split("_");c=c.splice(0,c.length-2).join("_");a=Fabrik.blocks[c]}else{c=f.target.getParent(".fabrikList");if(typeOf(c)!=="null"){c=c.id;a=Fabrik.blocks[c]}else{c=d.getParent(".floating-tip-wrapper").retrieve("list").id;a=Fabrik.blocks[c];if(a.options.actionMethod!==""){a.form.getElements("input[type=checkbox][name*=id], input[type=checkbox][name=checkAll]").each(function(e){e.checked=true})}}}if(!a.submit("list.delete")){f.stop()}};window.fireEvent("fabrik.loaded")}}());